    <meta charset="utf-8">
    <script src="d3.js"></script>
	<script src="topojson.js"></script>

	<title></title>

	<style>
		body {
			background-color: #eee;
		}
		.roads {
			fill: none;
			stroke: #000;
			stroke-width: .625px;
		}
		.arrests {
			fill: red;
			fill-opacity:.35;
			stroke: none;
		}
	</style>
	</head>

<body>
<script>
	var width = 960,
	    height = 600,
	    defScale = 266132,
	    defTranslate = [425693, 213458];

	var projection = d3.geo.mercator()
		.scale(266132)
		.translate([425693, 213458]);
	var path = d3.geo.path()
		.pointRadius(1)
		.projection(projection);
	var timeFormat = d3.time.format("%m/%e/%Y  %H:%M");

	var svg = d3.select("body").append("svg")
	    .attr("width", width)
		.attr("height", height)
		.call(d3.behavior.zoom().on("zoom", redraw));

	function redraw() {
		console.log("event: ", d3.event.scale);
		console.log("redraw scale",d3.event.scale * defScale);
		projection.scale(d3.event.scale * defScale);

		var xTranslate = d3.event.translate[0] + defTranslate[0],
			yTranslate = d3.event.translate[1] + defTranslate[1];
		console.log("redraw x: ", xTranslate);
		console.log("redraw y: ", yTranslate);

		//projection.translate([xTranslate, yTranslate]);
		svg.selectAll("path")
			.attr("d", path);

		svg.selectAll("circle")
			.attr("transform", function(d) {
				return "translate(" + projection([+d.longitude, +d.latitude]) + ")"; 
			});
		}

	d3.json("ic-map.json", function(error, IC) {

		svg.append("path")
			.datum(topojson.feature(IC, IC.objects.roads))
			.attr("class", "roads")
			.attr("d", path);

		d3.csv("arrests-geocoded.csv", function(arrests) {
			arrests.forEach(function(d) {
				d.charges = d.charges.split("\n");
				d.date = timeFormat.parse(d.date);
			});

			svg.selectAll("circle")
				.data(arrests)
				.enter()
				.append("circle")
				.attr("class", "arrests")
				.attr("r", function(d) {
					return 5 * d.charges.length;
				})
				.attr("transform", function(d) {return "translate(" + projection([+d.longitude, +d.latitude]) + ")"; })
				.append("title")
					.text(function(d) { return "Date: " + d.date + "\nCharges: " + d.charges; });
		console.log(arrests);
		});
	});
</script>
</body>
